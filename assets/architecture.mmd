flowchart LR
    %% æ•´ä½“æ¨ªå‘å¸ƒå±€ï¼Œåƒä¸€æ¡æµæ°´çº¿
    
    %% å®šä¹‰ä¸€äº›ç®€å•çš„æ ·å¼ï¼Œä¸è¦å¤ªèŠ±å“¨
    classDef plain fill:#fff,stroke:#333,stroke-width:1px;
    classDef db fill:#eee,stroke:#333,stroke-width:1px,stroke-dasharray: 5 5;
    
    start((Start)) --> input[CLI / Arguments]
    input --> init[GPU Manager Init]
    
    %% Python æ§åˆ¶å±‚ - ä½œä¸ºä¸€ä¸ªæ•´ä½“
    subgraph Host [ğŸ Host Context (Python)]
        direction TB
        init --> batcher[Batch Generator]
        batcher -->|1. Task Queue| thread[ThreadPool]
    end

    %% æ•°æ®ä¼ è¾“ - é‡ç‚¹æ ‡å‡º PCIe
    thread == "PCIe Bus (H2D)" ==> vram_in
    
    %% GPU è®¡ç®—å±‚
    subgraph Device [âš¡ Device Context (CUDA)]
        direction TB
        vram_in[(VRAM Input)] --> kernel[CUDA Kernel\n(Parallel Hash)]
        kernel --> vram_out[(Result Bitmap)]
    end
    
    %% ç»“æœå›ä¼ 
    vram_out == "PCIe Bus (D2H)" ==> filter
    
    %% éªŒè¯å±‚
    subgraph Verify [Validation]
        direction TB
        filter{Candidate?}
        check[UnRAR / CPU Verify]
    end
    
    filter -- Yes --> check
    filter -- No --> batcher
    
    check -- Pass --> found((âœ… Password Found))
    check -.->|False Positive| batcher

    %% åº”ç”¨æ ·å¼
    class input,init,batcher,thread,kernel,check,filter plain;
    class vram_in,vram_out db;
